# order_creator.py
from product_cart import Product, ShoppingCart
class OrderCreator:
    """
    User: Tạo đơn hàng & quét mã sản phẩm
    """
    def __init__(self, products):
        self.products = {p.code: p for p in products}
        self.cart = ShoppingCart()

    def search_product(self, keyword):
        keyword = keyword.lower()
        return [
            p for p in self.products.values()
            if keyword in p.code.lower() or keyword in p.name.lower()
        ]

    def scan_barcode(self, barcode):
        if barcode not in self.products:
            print("[!] Không tìm thấy sản phẩm!")
            return

        product = self.products[barcode]

        if product.stock <= 0:
            print(f"[!] '{product.name}' đã hết hàng!")
            return

        self.cart.add_product(product, 1)

# ====== DEMO ======
if __name__ == "__main__":
    products = [
        Product("SP001", "Áo croptop trắng", 10, 120000),
        Product("SP002", "Chân váy xếp ly", 0, 150000),
    ]

    user = OrderCreator(products)

    user.scan_barcode("SP001")
    user.scan_barcode("SP001")
    user.scan_barcode("SP002")
